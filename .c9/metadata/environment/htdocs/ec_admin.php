{"filter":false,"title":"ec_admin.php","tooltip":"/htdocs/ec_admin.php","undoManager":{"mark":27,"position":27,"stack":[[{"start":{"row":0,"column":0},"end":{"row":32,"column":7},"action":"remove","lines":["<!DOCTYPE html>","<html lang=\"ja\">","","<head>","    <meta charset=\"utf-8\">","    <title>ログインページ</title>","    <link type=\"text/css\" rel=\"stylesheet\" href=\"./css/common.css\">","</head>","","<body>","    <header>","        <div class=\"header-box\">","            <a href=\"./top.php\">","                <img class=\"logo\" src=\"./images/logo.png\" alt=\"CodeSHOP\">","            </a>","            <a href=\"./cart.php\" class=\"cart\"></a>","        </div>","    </header>","    <div class=\"content\">","        <div class=\"login\">","            <form method=\"post\" action=\"./login.php\">","                <div><input type=\"text\" name=\"user_name\" placeholder=\"ユーザー名\"></div>","                <div><input type=\"password\" name=\"password\" placeholder=\"パスワード\">","                    <div><input type=\"submit\" value=\"ログイン\">","            </form>","            <div class=\"account-create\">","                <a href=\"./ec_register.php\">ユーザーの新規作成</a>","            </div>","        </div>","    </div>","</body>","","</html>"],"id":2},{"start":{"row":0,"column":0},"end":{"row":82,"column":54},"action":"insert","lines":["<?php","// 設定ファイル読み込み","require_once '../../include/conf/const_drink.php';","// 関数ファイルみ込み","require_once '../../include/model/model_drink_tool.php';","//変数定義","date_default_timezone_set('Asia/Tokyo');","$date = date('-y-m-d H:i:s');","$sql_kind = '';","$new_name = '';","$new_price = '';","$new_stock = '';","$new_img = '';","$save_file = '';","$new_status = '';","$err_msgs = [];","$drink_id  = '';","$update_drink_id = '';","$update_stock = '';","$change_status = '';","$drink_lists = [];","$message = '';","$link = get_db_connect();","$request_method = get_request_method();","if($request_method === 'POST'){","    $sql_kind = get_post_data('sql_kind');","    //新規分の入力値エラーチェック","    if($sql_kind === 'insert'){","        $new_name = get_post_data('new_name');","        $new_price = get_post_data('new_price');","        $new_stock = get_post_data('new_stock');","        $new_status = get_post_data('new_status');","        $new_img = get_file_name_data('new_img');","        $save_file = get_file_tmp_name_data('new_img');","        if(check_name($new_name) !== ''){","            $err_msgs[] = check_price($new_name);","        }","        if(check_price($new_price) !== ''){","            $err_msgs[] = check_price($new_price);","        }","        if(check_stock($new_stock) !== ''){","            $err_msgs[] = check_price($new_stock);","        }","        if(check_img($new_img) !== ''){","            $err_msgs[] = check_img($new_img);","        }","       if(check_status($new_status) !== ''){","            $err_msgs[] = check_status($new_status);","        }","        //エラーがなければDBに商品追加処理","        if(count($err_msgs) === 0){","           $message =  upload_drink($link,$date,$new_name,$new_price,$new_status,$new_img,$save_file);","        }","    }","    //在庫数更新分の入力値エラーチェック","    if($sql_kind === 'update'){","        $update_drink_id = get_post_data('drink_id');","        $update_stock = get_post_data('update_stock');","        if(check_stock($update_stock) !== ''){","            $err_msgs[] = check_price($update_stock);","        }","        //エラーがなければ在庫数更新処理","        if (count($err_msgs) === 0){","            $message = update_stock($link,$date,$update_stock,$update_drink_id);","        }","    }","        //公開ステータス更新分の入力値エラーチェック","    if($sql_kind === 'change'){","        $update_drink_id = get_post_data('drink_id');","        $change_status = get_post_data('change_status');","        if(check_status($change_status) !== ''){","            $err_msgs[] = check_status($change_status);","        }","        //エラーがなければ公開ステータス更新処理","        if (count($err_msgs) === 0){","            $message = update_status($link,$date,$change_status,$update_drink_id);","        }","    }","}","$drink_lists = get_drink_list($link);","$drink_lists = entity_assoc_array($drink_lists);","close_db_connect($link);","include_once '../../include/view/view_drink_tool.php';"]}],[{"start":{"row":16,"column":5},"end":{"row":16,"column":6},"action":"remove","lines":["k"],"id":3},{"start":{"row":16,"column":4},"end":{"row":16,"column":5},"action":"remove","lines":["n"]},{"start":{"row":16,"column":3},"end":{"row":16,"column":4},"action":"remove","lines":["i"]},{"start":{"row":16,"column":2},"end":{"row":16,"column":3},"action":"remove","lines":["r"]},{"start":{"row":16,"column":1},"end":{"row":16,"column":2},"action":"remove","lines":["d"]}],[{"start":{"row":16,"column":1},"end":{"row":16,"column":2},"action":"insert","lines":["g"],"id":4},{"start":{"row":16,"column":2},"end":{"row":16,"column":3},"action":"insert","lines":["o"]},{"start":{"row":16,"column":3},"end":{"row":16,"column":4},"action":"insert","lines":["o"]},{"start":{"row":16,"column":4},"end":{"row":16,"column":5},"action":"insert","lines":["d"]},{"start":{"row":16,"column":5},"end":{"row":16,"column":6},"action":"insert","lines":["s"]}],[{"start":{"row":17,"column":12},"end":{"row":17,"column":13},"action":"remove","lines":["k"],"id":5},{"start":{"row":17,"column":11},"end":{"row":17,"column":12},"action":"remove","lines":["n"]},{"start":{"row":17,"column":10},"end":{"row":17,"column":11},"action":"remove","lines":["i"]},{"start":{"row":17,"column":9},"end":{"row":17,"column":10},"action":"remove","lines":["r"]},{"start":{"row":17,"column":8},"end":{"row":17,"column":9},"action":"remove","lines":["d"]}],[{"start":{"row":17,"column":8},"end":{"row":17,"column":9},"action":"insert","lines":["g"],"id":6},{"start":{"row":17,"column":9},"end":{"row":17,"column":10},"action":"insert","lines":["o"]},{"start":{"row":17,"column":10},"end":{"row":17,"column":11},"action":"insert","lines":["o"]},{"start":{"row":17,"column":11},"end":{"row":17,"column":12},"action":"insert","lines":["d"]},{"start":{"row":17,"column":12},"end":{"row":17,"column":13},"action":"insert","lines":["s"]}],[{"start":{"row":20,"column":5},"end":{"row":20,"column":6},"action":"remove","lines":["k"],"id":7},{"start":{"row":20,"column":4},"end":{"row":20,"column":5},"action":"remove","lines":["n"]},{"start":{"row":20,"column":3},"end":{"row":20,"column":4},"action":"remove","lines":["i"]},{"start":{"row":20,"column":2},"end":{"row":20,"column":3},"action":"remove","lines":["r"]},{"start":{"row":20,"column":1},"end":{"row":20,"column":2},"action":"remove","lines":["d"]}],[{"start":{"row":20,"column":1},"end":{"row":20,"column":2},"action":"insert","lines":["g"],"id":8},{"start":{"row":20,"column":2},"end":{"row":20,"column":3},"action":"insert","lines":["o"]},{"start":{"row":20,"column":3},"end":{"row":20,"column":4},"action":"insert","lines":["o"]},{"start":{"row":20,"column":4},"end":{"row":20,"column":5},"action":"insert","lines":["d"]},{"start":{"row":20,"column":5},"end":{"row":20,"column":6},"action":"insert","lines":["s"]}],[{"start":{"row":79,"column":5},"end":{"row":79,"column":6},"action":"remove","lines":["k"],"id":9},{"start":{"row":79,"column":4},"end":{"row":79,"column":5},"action":"remove","lines":["n"]},{"start":{"row":79,"column":3},"end":{"row":79,"column":4},"action":"remove","lines":["i"]},{"start":{"row":79,"column":2},"end":{"row":79,"column":3},"action":"remove","lines":["r"]},{"start":{"row":79,"column":1},"end":{"row":79,"column":2},"action":"remove","lines":["d"]}],[{"start":{"row":79,"column":1},"end":{"row":79,"column":2},"action":"insert","lines":["g"],"id":10},{"start":{"row":79,"column":2},"end":{"row":79,"column":3},"action":"insert","lines":["o"]},{"start":{"row":79,"column":3},"end":{"row":79,"column":4},"action":"insert","lines":["o"]},{"start":{"row":79,"column":4},"end":{"row":79,"column":5},"action":"insert","lines":["d"]},{"start":{"row":79,"column":5},"end":{"row":79,"column":6},"action":"insert","lines":["s"]}],[{"start":{"row":79,"column":0},"end":{"row":79,"column":12},"action":"remove","lines":["$goods_lists"],"id":11},{"start":{"row":79,"column":0},"end":{"row":79,"column":12},"action":"insert","lines":["$goods_lists"]}],[{"start":{"row":80,"column":5},"end":{"row":80,"column":6},"action":"remove","lines":["k"],"id":12},{"start":{"row":80,"column":4},"end":{"row":80,"column":5},"action":"remove","lines":["n"]},{"start":{"row":80,"column":3},"end":{"row":80,"column":4},"action":"remove","lines":["i"]},{"start":{"row":80,"column":2},"end":{"row":80,"column":3},"action":"remove","lines":["r"]},{"start":{"row":80,"column":1},"end":{"row":80,"column":2},"action":"remove","lines":["d"]}],[{"start":{"row":80,"column":1},"end":{"row":80,"column":2},"action":"insert","lines":["g"],"id":13},{"start":{"row":80,"column":2},"end":{"row":80,"column":3},"action":"insert","lines":["o"]},{"start":{"row":80,"column":3},"end":{"row":80,"column":4},"action":"insert","lines":["o"]},{"start":{"row":80,"column":4},"end":{"row":80,"column":5},"action":"insert","lines":["d"]},{"start":{"row":80,"column":5},"end":{"row":80,"column":6},"action":"insert","lines":["s"]}],[{"start":{"row":80,"column":0},"end":{"row":80,"column":12},"action":"remove","lines":["$goods_lists"],"id":14},{"start":{"row":80,"column":0},"end":{"row":80,"column":12},"action":"insert","lines":["$goods_lists"]}],[{"start":{"row":80,"column":39},"end":{"row":80,"column":40},"action":"remove","lines":["k"],"id":15},{"start":{"row":80,"column":38},"end":{"row":80,"column":39},"action":"remove","lines":["n"]},{"start":{"row":80,"column":37},"end":{"row":80,"column":38},"action":"remove","lines":["i"]},{"start":{"row":80,"column":36},"end":{"row":80,"column":37},"action":"remove","lines":["r"]},{"start":{"row":80,"column":35},"end":{"row":80,"column":36},"action":"remove","lines":["d"]}],[{"start":{"row":80,"column":35},"end":{"row":80,"column":36},"action":"insert","lines":["g"],"id":16},{"start":{"row":80,"column":36},"end":{"row":80,"column":37},"action":"insert","lines":["o"]},{"start":{"row":80,"column":37},"end":{"row":80,"column":38},"action":"insert","lines":["o"]},{"start":{"row":80,"column":38},"end":{"row":80,"column":39},"action":"insert","lines":["d"]},{"start":{"row":80,"column":39},"end":{"row":80,"column":40},"action":"insert","lines":["s"]}],[{"start":{"row":82,"column":47},"end":{"row":82,"column":48},"action":"remove","lines":["l"],"id":17},{"start":{"row":82,"column":46},"end":{"row":82,"column":47},"action":"remove","lines":["o"]},{"start":{"row":82,"column":45},"end":{"row":82,"column":46},"action":"remove","lines":["o"]},{"start":{"row":82,"column":44},"end":{"row":82,"column":45},"action":"remove","lines":["t"]},{"start":{"row":82,"column":43},"end":{"row":82,"column":44},"action":"remove","lines":["_"]},{"start":{"row":82,"column":42},"end":{"row":82,"column":43},"action":"remove","lines":["k"]},{"start":{"row":82,"column":41},"end":{"row":82,"column":42},"action":"remove","lines":["n"]},{"start":{"row":82,"column":40},"end":{"row":82,"column":41},"action":"remove","lines":["i"]},{"start":{"row":82,"column":39},"end":{"row":82,"column":40},"action":"remove","lines":["r"]},{"start":{"row":82,"column":38},"end":{"row":82,"column":39},"action":"remove","lines":["d"]}],[{"start":{"row":82,"column":38},"end":{"row":82,"column":39},"action":"insert","lines":["e"],"id":18},{"start":{"row":82,"column":39},"end":{"row":82,"column":40},"action":"insert","lines":["c"]},{"start":{"row":82,"column":40},"end":{"row":82,"column":41},"action":"insert","lines":["_"]},{"start":{"row":82,"column":41},"end":{"row":82,"column":42},"action":"insert","lines":["a"]},{"start":{"row":82,"column":42},"end":{"row":82,"column":43},"action":"insert","lines":["d"]}],[{"start":{"row":82,"column":43},"end":{"row":82,"column":44},"action":"insert","lines":["m"],"id":19},{"start":{"row":82,"column":44},"end":{"row":82,"column":45},"action":"insert","lines":["i"]},{"start":{"row":82,"column":45},"end":{"row":82,"column":46},"action":"insert","lines":["n"]}],[{"start":{"row":2,"column":43},"end":{"row":2,"column":44},"action":"remove","lines":["k"],"id":20},{"start":{"row":2,"column":42},"end":{"row":2,"column":43},"action":"remove","lines":["n"]},{"start":{"row":2,"column":41},"end":{"row":2,"column":42},"action":"remove","lines":["i"]},{"start":{"row":2,"column":40},"end":{"row":2,"column":41},"action":"remove","lines":["r"]},{"start":{"row":2,"column":39},"end":{"row":2,"column":40},"action":"remove","lines":["d"]},{"start":{"row":2,"column":38},"end":{"row":2,"column":39},"action":"remove","lines":["_"]}],[{"start":{"row":2,"column":33},"end":{"row":2,"column":34},"action":"insert","lines":["e"],"id":21},{"start":{"row":2,"column":34},"end":{"row":2,"column":35},"action":"insert","lines":["c"]},{"start":{"row":2,"column":35},"end":{"row":2,"column":36},"action":"insert","lines":["_"]}],[{"start":{"row":4,"column":44},"end":{"row":4,"column":45},"action":"remove","lines":["k"],"id":22},{"start":{"row":4,"column":43},"end":{"row":4,"column":44},"action":"remove","lines":["n"]},{"start":{"row":4,"column":42},"end":{"row":4,"column":43},"action":"remove","lines":["i"]},{"start":{"row":4,"column":41},"end":{"row":4,"column":42},"action":"remove","lines":["r"]},{"start":{"row":4,"column":40},"end":{"row":4,"column":41},"action":"remove","lines":["d"]}],[{"start":{"row":4,"column":40},"end":{"row":4,"column":41},"action":"insert","lines":["e"],"id":23},{"start":{"row":4,"column":41},"end":{"row":4,"column":42},"action":"insert","lines":["c"]}],[{"start":{"row":4,"column":38},"end":{"row":4,"column":39},"action":"remove","lines":["l"],"id":24},{"start":{"row":4,"column":37},"end":{"row":4,"column":38},"action":"remove","lines":["e"]},{"start":{"row":4,"column":36},"end":{"row":4,"column":37},"action":"remove","lines":["d"]},{"start":{"row":4,"column":35},"end":{"row":4,"column":36},"action":"remove","lines":["o"]},{"start":{"row":4,"column":34},"end":{"row":4,"column":35},"action":"remove","lines":["m"]}],[{"start":{"row":4,"column":34},"end":{"row":4,"column":35},"action":"insert","lines":["f"],"id":25},{"start":{"row":4,"column":35},"end":{"row":4,"column":36},"action":"insert","lines":["u"]},{"start":{"row":4,"column":36},"end":{"row":4,"column":37},"action":"insert","lines":["n"]},{"start":{"row":4,"column":37},"end":{"row":4,"column":38},"action":"insert","lines":["c"]},{"start":{"row":4,"column":38},"end":{"row":4,"column":39},"action":"insert","lines":["t"]},{"start":{"row":4,"column":39},"end":{"row":4,"column":40},"action":"insert","lines":["i"]},{"start":{"row":4,"column":40},"end":{"row":4,"column":41},"action":"insert","lines":["o"]},{"start":{"row":4,"column":41},"end":{"row":4,"column":42},"action":"insert","lines":["n"]}],[{"start":{"row":4,"column":49},"end":{"row":4,"column":50},"action":"remove","lines":["l"],"id":26},{"start":{"row":4,"column":48},"end":{"row":4,"column":49},"action":"remove","lines":["o"]},{"start":{"row":4,"column":47},"end":{"row":4,"column":48},"action":"remove","lines":["o"]},{"start":{"row":4,"column":46},"end":{"row":4,"column":47},"action":"remove","lines":["t"]}],[{"start":{"row":4,"column":46},"end":{"row":4,"column":47},"action":"insert","lines":["a"],"id":27},{"start":{"row":4,"column":47},"end":{"row":4,"column":48},"action":"insert","lines":["d"]},{"start":{"row":4,"column":48},"end":{"row":4,"column":49},"action":"insert","lines":["m"]},{"start":{"row":4,"column":49},"end":{"row":4,"column":50},"action":"insert","lines":["i"]},{"start":{"row":4,"column":50},"end":{"row":4,"column":51},"action":"insert","lines":["n"]}],[{"start":{"row":4,"column":50},"end":{"row":4,"column":51},"action":"remove","lines":["n"],"id":28},{"start":{"row":4,"column":49},"end":{"row":4,"column":50},"action":"remove","lines":["i"]},{"start":{"row":4,"column":48},"end":{"row":4,"column":49},"action":"remove","lines":["m"]},{"start":{"row":4,"column":47},"end":{"row":4,"column":48},"action":"remove","lines":["d"]},{"start":{"row":4,"column":46},"end":{"row":4,"column":47},"action":"remove","lines":["a"]},{"start":{"row":4,"column":45},"end":{"row":4,"column":46},"action":"remove","lines":["_"]},{"start":{"row":4,"column":44},"end":{"row":4,"column":45},"action":"remove","lines":["c"]},{"start":{"row":4,"column":43},"end":{"row":4,"column":44},"action":"remove","lines":["e"]},{"start":{"row":4,"column":42},"end":{"row":4,"column":43},"action":"remove","lines":["_"]}],[{"start":{"row":4,"column":34},"end":{"row":4,"column":35},"action":"insert","lines":["e"],"id":29},{"start":{"row":4,"column":35},"end":{"row":4,"column":36},"action":"insert","lines":["c"]},{"start":{"row":4,"column":36},"end":{"row":4,"column":37},"action":"insert","lines":["_"]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":24,"column":31},"end":{"row":24,"column":31},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1599874911002,"hash":"f696754633e83a62baccd7d2ad3bc15e849a207a"}